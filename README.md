# trading_bot_algorithm
простой алгоритм торгового бота на основе скользящих средних и стоп-лосса, визуализация (свечной график)  
# Текст задания

Разработать алгоритм торгового робота, который автоматически совершает сделки на основе скользящих средних и стоп-лосса, анализируя исторические данные акций.

Обязательно использовать реальные дневные данные стоимости акций с бирж, например нью-йоркской или московской биржи.
---

## Обязательные переменные:
1. **`money`** – стартовый капитал (1 000 000 денежных единиц).  
2. **`start`** – дата начала периода в формате `YYYY-MM-DD` (2015-01-01).  
3. **`finish`** – дата окончания периода в формате `YYYY-MM-DD` (2020-12-31).  
4. **`stop_loss`** – уровень стоп-лосса (5% от цены покупки).  
5. **`short_window`** – размер короткого скользящего окна (30 торговых дней).  
6. **`long_window`** – размер длинного скользящего окна (90 торговых дней).  

**Примечания:**  
- Скользящие окна рассчитываются как **простое среднее**.  
- Все переменные объявляются в отдельном блоке **после импорта библиотек**.

---

## Правила торговли:
### Сигналы:
- **`sig_buy`** (покупка):  
  Короткая скользящая средняя пересекает длинную **снизу вверх**.  
- **`sig_sale`** (продажа):  
  Короткая скользящая средняя пересекает длинную **сверху вниз**.  

### Исполнение сделок:
- Покупка/продажа происходит **на следующий день** после сигнала по цене открытия.  
- При покупке:  
  - Используется **весь доступный капитал**.  
  - Покупается **максимально возможное целое количество акций**.  
  - Фиксируется **стоп-лосс** на уровне:  
    `цена покупки × (1 - stop_loss / 100)`.  
- При продаже:  
  - Продается **весь объем акций**.  
  - Стоп-лосс срабатывает, если **цена Low** в любой день (включая день покупки) опускается ниже уровня стоп-лосса.  
  - Продажа происходит **по цене стоп-лосса**, даже если фактическая цена ниже.

---

## Исходные данные:
- Формат данных: `Pandas DataFrame`.  
- Индекс: дата/время (тип `datetime`).  
- Колонки (обязательный порядок):  
  `Open`, `High`, `Low`, `Close`.  
- Источник данных: реальные дневные котировки с **NYSE** или **Московской биржи**.  

---

## Визуализация:
### Верхнее окно:
- **График цен**:  
  - Тип: свечи (`candlestick`) или OHLC.  
  - Динамический масштаб (возможность приближения/удаления).  
  - Наложение скользящих средних:  
    - Короткая (30 дней) — синяя линия.  
    - Длинная (90 дней) — оранжевая линия.  
- **Сигналы**:  
  - `sig_buy` — зеленый треугольник (▲) вверх.  
  - `sig_sale` — красный треугольник (▼) вниз.  
  - `stop-loss` — черный треугольник (▼) вниз.  

### Нижнее окно:
- **График позиции**:  
  - Ось Y: `1` (все средства в акциях), `0` (все средства в кэше).  


---
